{% extends 'base.html.twig' %}
{% block body %}

    <div class="row justify-content-center">
        <div class="col col-lg-8">

            <div class="title-vends row justify-content-center p-3">
                <img src="{{ asset('images/estim_title.png') }}" alt="Estime ton tél">
            </div>
            <div class="row">
                <div class="col-12">
                    <h1 class="primary-title text-left">
                        <img class="img-fleche mr-lg-2" src="{{ asset('images/fleche_droite.png') }}" alt="→">Voici quelques questions...</h1>
                    <p>Pour nous aider à estimer la valeur de ton téléphone, sois honnête sur sa description pour en
                    connaître sa valeur réelle</p>
                </div>
            </div>

            <section id="brand">
                <div class="row">
                    <div class="col-12 text-center p-5">
                        <span class="estim-round-bubble">Quelle est la marque de ton mobile&#8239;?</span>
                    </div>
                    {% for brand in brands %}
                        <div class="col mx-auto text-center p-1">
                    <a class="grey-button brand" id="{{ brand.brand }}" href="{{ path('estimation_brand', {'brand':brand.brand}) }}">{{ brand.brand }}</a>
                        </div>
                    {% endfor %}
                </div>
                <div class="row">
                    <div class="col-12 mx-auto text-center form p-4">
                        <a class="grey-button" href="{{ path("autres") }}">Autre marque</a>
                    </div>
                </div>
            </section>

            <section>
                <div class="row">
                    <div class="col-12 mx-auto text-center p-4">
                        <div id="patience"></div>
                    </div>
                </div>
            </section>

            <section id="model" style="display:none;">
                {% block models %}
                <div class="row">
                    <div class="col-12 text-center p-5">
                        <span class="estim-round-bubble">Quel est le modèle&#8239;?</span>
                    </div>
                    {% for model in models %}
                        <div class="col mx-auto text-center p-1">
                            <a class="grey-button" href="{{ path('estimation_capacity', {'capacity':model.capacity}) }}">{{ model.capacity }}</a>
                        </div>
                    {% endfor %}
                </div>
                <div class="row">
                    <div class="col-12 mx-auto text-center form p-4">
                        <a class="grey-button" href="{{ path("autres") }}">Autre modèle</a>
                    </div>
                </div>
                {% endblock %}
            </section>

        </div>
    </div>
{% endblock %}

{%  block javascripts %}
    <script src=
            "https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js">
    </script>
    <script>
        // au clic sur une marque
        $('.brand').click(function(){
            $('#patience').html('<img src="{{ asset('images/ajax-loader.gif') }}">');
            const brand = $(this).attr('id');
            // ça va chercher les modeles en requête json
            $.ajax({
                type: "POST",
                url: "{{ path('model_id') }}",
                data: {brand: brand},
                success : function(models){
                    console.log(models);
                    // et ça show le modele
                    $('#model').show();
                    $('#model').append("<p>ici on affiche les modèles<br>" +
                        "Test : {% for model in models %}{{ model }}{% endfor %}</p>");
                },
            });
        });
    </script>
{% endblock %}